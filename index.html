<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Alpina Chat</title>
</head>
<body>
<h2>Alpina Chat</h2>
<input id="input" placeholder="Votre question...">
<button id="send">Envoyer</button>
<div id="chat"></div>

<script>
const input = document.getElementById("input");
const chatDiv = document.getElementById("chat");

document.getElementById("send").onclick = async () => {
  const message = input.value.trim();
  if (!message) return;
  input.value = "";

  const userDiv = document.createElement("div");
  userDiv.textContent = "Vous : " + message;
  chatDiv.appendChild(userDiv);

  try {
    const response = await fetch("https://alpina-chat.vercel.app", {
      method: "POST",
      mode: "cors",
      headers: { "Content-Type": "text/plain" }, // On utilise text/plain pour Ã©viter le blocage CORS complexe
      body: JSON.stringify({ message: val })
    });
    const data = await response.json();
    document.getElementById('alp-loading-indicator')?.remove();

    const aiMsg = document.createElement('div');
    aiMsg.style = "background:#fff; padding:10px; border-radius:12px 12px 12px 0; align-self:flex-start; border-left:3px solid #D4AF37; max-width:80%; box-shadow:0 2px 5px rgba(0,0,0,0.05); margin-bottom:5px; line-height:1.4; color:#333;";
    aiMsg.textContent = data.text;
    m.appendChild(aiMsg);
  }
catch {
    const errDiv = document.createElement("div");
    errDiv.textContent = "Erreur de connexion.";
    chatDiv.appendChild(errDiv);
  }
};
</script>
</body>
</html>
